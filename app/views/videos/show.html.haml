%article.video
  .container
    .row
      .video_large_cover.span7.offset1
        %img(src="/tmp/#{@video.large_cover_url}")
      .video_info.span3
        %header
          %h3= @video.title
          - ratings = []
          - @video.user_reviews.each do |review|
            - ratings << review.rating
          - ratings = ratings.inject(:+)
          %span Average Rating: #{ratings.to_f / @video.user_reviews.count.to_f}
        %p= @video.description
        .actions
          %a.btn.btn-primary(href="") Watch Now
          %a.btn(href="") + My Queue
%section.reviews.container
  .row
    .span10.offset1
      = form_for [@video, UserReview.new] do |f|
        %fieldset
          %label Rate this video
          = f.select :rating, options_for_select([5, 4, 3, 2, 1].map { |number| [pluralize(number, "Star")]})
          %label Write Review
          =f.text_area :body, rows: 6, class: "span6"
        %fieldset.actions.clearfix
          %input(type="submit" value="Submit" class="btn")
          = link_to "Cancel", @video
      %header
        %h3 User Reviews (#{@user_reviews.count})
      %ul
        - @user_reviews.each do |review|
          %article.review
            %li.row
              .span2
                %span Rating: #{review.rating}
                %p by <a href="">#{review.user.full_name}</a>
              .span8
                %p #{review.body}